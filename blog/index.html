<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog - CF Ng's Non Financial Advice</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <style>
        .blog-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .blog-list {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        
        .blog-post {
            border-bottom: 1px solid #eee;
            padding-bottom: 2rem;
        }
        
        .blog-post:last-child {
            border-bottom: none;
        }
        
        .blog-title {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            color: #333;
            text-decoration: none;
        }
        
        .blog-title:hover {
            color: #007bff;
        }
        
        .blog-meta {
            color: #666;
            margin-bottom: 1rem;
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .blog-category {
            background-color: #f0f0f0;
            padding: 0.2rem 0.8rem;
            border-radius: 15px;
        }
        
        .blog-summary {
            color: #444;
            line-height: 1.6;
        }
        
        .year-section {
            margin-bottom: 3rem;
        }
        
        .year-heading {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            color: #333;
        }
    </style>
</head>
<body>
    <div id="header"></div>
    
    <main>
        <div class="blog-container">
            <h1>Blog Posts</h1>
            <div id="blog-content" class="blog-list">
                <!-- Posts will be dynamically inserted here -->
            </div>
        </div>
    </main>
    
    <div id="footer"></div>

    <script src="/assets/js/blog-data.js"></script>
    <script>
        // Load header, nav, and footer components
        fetch('/components/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header').innerHTML = data;
                return fetch('/components/nav.html');
            })
            .then(response => response.text())
            .then(data => {
                document.getElementById('nav').innerHTML = data;
            });

        fetch('/components/footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });

        // Function to group posts by year
        function groupPostsByYear(posts) {
            return posts.reduce((acc, post) => {
                const year = new Date(post.date).getFullYear();
                if (!acc[year]) {
                    acc[year] = [];
                }
                acc[year].push(post);
                return acc;
            }, {});
        }

        // Function to format date
        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Render blog posts
        function renderBlogPosts() {
            const blogContent = document.getElementById('blog-content');
            const postsByYear = groupPostsByYear(blogPosts);
            
            // Sort years in descending order
            const years = Object.keys(postsByYear).sort((a, b) => b - a);
            
            const html = years.map(year => `
                <div class="year-section">
                    <h2 class="year-heading">${year}</h2>
                    ${postsByYear[year].map(post => `
                        <article class="blog-post">
                            <a href="/${post.path}" class="blog-title">
                                <h3>${post.title}</h3>
                            </a>
                            <div class="blog-meta">
                                <time datetime="${post.date}">${formatDate(post.date)}</time>
                                <span class="blog-category">${post.category}</span>
                            </div>
                            <p class="blog-summary">${post.summary}</p>
                        </article>
                    `).join('')}
                </div>
            `).join('');
            
            blogContent.innerHTML = html;
        }

        // Initial render
        renderBlogPosts();
    </script>
</body>
</html>
